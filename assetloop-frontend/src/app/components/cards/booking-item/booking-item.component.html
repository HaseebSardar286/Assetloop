<div class="card h-100 shadow-sm position-relative">
  <img
    [src]="booking.imageUrl || '/images/download.jpg'"
    class="card-img-top"
    [alt]="booking.name"
  />
  <div class="card-body">
    <h5 class="card-title">{{ booking.name }}</h5>
    <p class="card-text">
      <strong>Category:</strong> {{ booking.category || "N/A" }}
    </p>
    <p class="card-text"><strong>Location:</strong> {{ booking.address }}</p>
    <p class="card-text">
      <strong>Price:</strong> ${{ booking.price || booking.totalPaid || 0 }}
    </p>
    <span
      class="badge me-1"
      [ngClass]="{
        'bg-success': booking.status === 'confirmed',
        'bg-warning': booking.status === 'pending',
        'bg-danger': booking.status === 'cancelled',
        'bg-primary': booking.status === 'completed',
        'bg-info': booking.status === 'active'
      }"
      >{{ booking.status }}</span
    >
    <span *ngIf="likedCount" class="badge bg-info">{{ likedCount }} Likes</span>
    <div *ngIf="booking.endDate" class="mt-2">
      <small class="text-muted">
        <strong>End Date:</strong> {{ booking.endDate | date:'mediumDate' }}
      </small>
    </div>
    <div *ngIf="!isReviewable() && !booking.review && booking.status !== 'cancelled' && booking.endDate" class="mt-1">
      <small class="text-info">
        <em>Review available after end date</em>
      </small>
    </div>
    <input
      type="text"
      class="form-control mt-2"
      placeholder="Add a note..."
      (input)="onNotesChange($event)"
    />
  </div>
  <div class="card-footer d-flex justify-content-between align-items-center">
    <div>
      <button
        class="btn btn-outline-danger btn-sm me-2"
        (click)="onRemoveFavourite()"
      >
        <fa-icon [icon]="faTrash" *ngIf="isFavourite"></fa-icon>
        <fa-icon [icon]="faHeart" *ngIf="!isFavourite"></fa-icon>
      </button>
      <button
        class="btn btn-outline-primary btn-sm me-2"
        (click)="onAddToCart()"
      >
        <fa-icon [icon]="faShoppingCart"></fa-icon>
      </button>
      <button class="btn btn-outline-secondary btn-sm me-2" (click)="onShare()">
        <fa-icon [icon]="faShare"></fa-icon>
      </button>
      <button class="btn btn-outline-success btn-sm" (click)="startChatWithOwner()">
        üí¨ Chat
      </button>
    </div>
    <div class="d-flex align-items-center gap-2">
      <button class="btn btn-primary btn-sm" (click)="onViewListing()">
        View Listing
      </button>
      <button
        class="btn btn-danger btn-sm"
        *ngIf="booking.status !== 'cancelled'"
        (click)="onCancelBooking()"
      >
        Cancel
      </button>
      <button
        class="btn btn-success btn-sm"
        *ngIf="isReviewable()"
        (click)="onLeaveReview()"
        title="Leave a review for this booking"
      >
        ‚≠ê Leave Review
      </button>
      <span
        *ngIf="booking.review"
        class="badge bg-success ms-2"
        title="You have already reviewed this booking"
      >
        ‚úì Reviewed
      </span>
    </div>
  </div>
</div>
