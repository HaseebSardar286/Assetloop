<div class="d-flex flex-column vh-100">
  <app-header></app-header>
  <div class="d-flex flex-grow-1">
    <app-renter-side-bar></app-renter-side-bar>
    <main class="flex-grow-1 p-4 bg-light">
      <div class="container" style="max-width: 600px">
        <h2 class="mb-4">Leave a Review</h2>
        
        <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
          {{ error }}
          <button type="button" class="btn-close" (click)="error = null" aria-label="Close"></button>
        </div>

        <div *ngIf="success" class="alert alert-success alert-dismissible fade show" role="alert">
          <strong>Success!</strong> Your review has been submitted. Redirecting...
        </div>

        <form
          (ngSubmit)="submit()"
          #form="ngForm"
          class="card p-4 shadow-sm"
        >
          <div class="mb-4">
            <label class="form-label fw-bold mb-3">Rating *</label>
            <div class="star-rating d-flex gap-2 align-items-center">
              <span
                *ngFor="let star of [1, 2, 3, 4, 5]"
                class="star"
                [ngClass]="getStarClass(star)"
                (click)="setRating(star)"
                (mouseenter)="setHoveredRating(star)"
                (mouseleave)="clearHoveredRating()"
                [title]="star + ' star' + (star > 1 ? 's' : '')"
              >
                â˜…
              </span>
              <span class="ms-2 text-muted">
                <span *ngIf="rating > 0">{{ rating }}/5</span>
                <span *ngIf="rating === 0">Click to rate</span>
              </span>
            </div>
          </div>

          <div class="mb-4">
            <label for="comment" class="form-label fw-bold">Your Review *</label>
            <textarea
              id="comment"
              class="form-control"
              [(ngModel)]="comment"
              name="comment"
              rows="6"
              placeholder="Share your experience with this product..."
              required
            ></textarea>
            <small class="form-text text-muted">
              Please provide detailed feedback about your experience
            </small>
          </div>

          <div class="d-flex gap-2 justify-content-end">
            <button 
              type="button" 
              class="btn btn-outline-secondary" 
              (click)="cancel()"
              [disabled]="loading"
            >
              Cancel
            </button>
            <button 
              class="btn btn-primary" 
              type="submit" 
              [disabled]="loading || rating === 0 || !comment.trim()"
            >
              <span *ngIf="loading" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
              {{ loading ? "Submitting..." : "Submit Review" }}
            </button>
          </div>
        </form>
      </div>
    </main>
  </div>
</div>
